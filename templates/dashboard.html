<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CryptoCurrency AI Trading Bot Dashboard (Experimental)</title>
    <link rel="icon" type="image/x-icon" href="/static/favicon.ico">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Enhanced Dashboard CSS -->
    <link rel="stylesheet" href="/static/enhanced-dashboard.css">
    <style>
        /* Legacy styles - kept for backward compatibility */
        .status-open { @apply bg-blue-500 text-white px-2 py-1 rounded text-xs; }
        .status-closed { @apply bg-green-500 text-white px-2 py-1 rounded text-xs; }
        
        /* Mobile optimizations */
        @media (max-width: 640px) {
            .mobile-compact { @apply text-sm; }
            .mobile-hide { @apply hidden; }
            .mobile-scroll { @apply overflow-x-auto; }
            .mobile-stack { @apply flex-col space-y-2 space-x-0; }
        }
        
        /* Chart responsiveness */
        .chart-container { 
            position: relative; 
            height: 250px;
        }
        
        @media (max-width: 640px) {
            .chart-container { 
                height: 200px;
            }
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen">
    <!-- Header -->
    <header class="bg-white shadow-sm border-b">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center py-4 space-y-3 sm:space-y-0">
                <h1 class="text-xl sm:text-2xl font-bold text-gray-900">ü§ñ CryptoCurrency AI Trading Bot Dashboard (Experimental)</h1>
                <div class="flex items-center space-x-2 sm:space-x-4 w-full sm:w-auto mobile-stack sm:flex-row">
                    <select id="symbolSelect" class="focus-visible border border-gray-300 rounded-lg px-2 py-1 sm:px-3 sm:py-2 text-sm sm:text-base flex-1 sm:flex-none transition-all duration-200 hover:border-gray-400" aria-label="Select trading symbol">
                        <option value="SUIUSDC">SUIUSDC</option>
                    </select>
                    <select id="timeRange" class="focus-visible border border-gray-300 rounded-lg px-2 py-1 sm:px-3 sm:py-2 text-sm sm:text-base flex-1 sm:flex-none transition-all duration-200 hover:border-gray-400" aria-label="Select time range">
                        <option value="7">7 Days</option>
                        <option value="30" selected>30 Days</option>
                        <option value="90">90 Days</option>
                    </select>
                    <button id="refreshBtn" class="btn btn-primary btn-sm flex-1 sm:flex-none" aria-label="Refresh dashboard data">
                        üîÑ <span class="hidden sm:inline">Refresh</span>
                    </button>
                    <button id="logsBtn" class="btn btn-success btn-sm flex-1 sm:flex-none" aria-label="View system logs">
                        üìã <span class="hidden sm:inline">Logs</span>
                    </button>
                    <button id="pauseBtn" class="btn btn-warning btn-sm flex-1 sm:flex-none" aria-label="Pause trading bot">
                        ‚è∏Ô∏è <span class="hidden sm:inline" id="pauseBtnText">Pause</span>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <!-- System Status - Enhanced Design -->
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-8">
            <!-- Total Signals Card -->
            <div class="bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl shadow-lg p-6 text-white fade-in transform transition-all duration-200 hover:scale-105 hover:shadow-xl" role="region" aria-label="Total Signals">
                <div class="flex items-center justify-between mb-2">
                    <div class="text-sm font-medium text-blue-100 uppercase tracking-wide">Total Signals</div>
                    <div class="bg-white/20 rounded-lg p-2 backdrop-blur-sm">
                        <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M2 11a1 1 0 011-1h2a1 1 0 011 1v5a1 1 0 01-1 1H3a1 1 0 01-1-1v-5zM8 7a1 1 0 011-1h2a1 1 0 011 1v9a1 1 0 01-1 1H9a1 1 0 01-1-1V7zM14 4a1 1 0 011-1h2a1 1 0 011 1v12a1 1 0 01-1 1h-2a1 1 0 01-1-1V4z"/>
                        </svg>
                    </div>
                </div>
                <div class="text-4xl font-bold tracking-tight" id="totalSignals" aria-live="polite">-</div>
                <div class="mt-2 text-xs text-blue-100">All time signals generated</div>
            </div>

            <!-- Total Trades Card -->
            <div class="bg-gradient-to-br from-purple-500 to-purple-600 rounded-xl shadow-lg p-6 text-white fade-in transform transition-all duration-200 hover:scale-105 hover:shadow-xl" role="region" aria-label="Total Trades" style="animation-delay: 0.1s;">
                <div class="flex items-center justify-between mb-2">
                    <div class="text-sm font-medium text-purple-100 uppercase tracking-wide">Total Trades</div>
                    <div class="bg-white/20 rounded-lg p-2 backdrop-blur-sm">
                        <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8.433 7.418c.155-.103.346-.196.567-.267v1.698a2.305 2.305 0 01-.567-.267C8.07 8.34 8 8.114 8 8c0-.114.07-.34.433-.582zM11 12.849v-1.698c.22.071.412.164.567.267.364.243.433.468.433.582 0 .114-.07.34-.433.582a2.305 2.305 0 01-.567.267z"/>
                            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-13a1 1 0 10-2 0v.092a4.535 4.535 0 00-1.676.662C6.602 6.234 6 7.009 6 8c0 .99.602 1.765 1.324 2.246.48.32 1.054.545 1.676.662v1.941c-.391-.127-.68-.317-.843-.504a1 1 0 10-1.51 1.31c.562.649 1.413 1.076 2.353 1.253V15a1 1 0 102 0v-.092a4.535 4.535 0 001.676-.662C13.398 13.766 14 12.991 14 12c0-.99-.602-1.765-1.324-2.246A4.535 4.535 0 0011 9.092V7.151c.391.127.68.317.843.504a1 1 0 101.511-1.31c-.563-.649-1.413-1.076-2.354-1.253V5z" clip-rule="evenodd"/>
                        </svg>
                    </div>
                </div>
                <div class="text-4xl font-bold tracking-tight" id="totalTrades" aria-live="polite">-</div>
                <div class="mt-2 text-xs text-purple-100">Executed positions</div>
            </div>

            <!-- Open Positions Card -->
            <div class="bg-gradient-to-br from-green-500 to-green-600 rounded-xl shadow-lg p-6 text-white fade-in transform transition-all duration-200 hover:scale-105 hover:shadow-xl" role="region" aria-label="Open Positions" style="animation-delay: 0.2s;">
                <div class="flex items-center justify-between mb-2">
                    <div class="text-sm font-medium text-green-100 uppercase tracking-wide">Open Positions</div>
                    <div class="bg-white/20 rounded-lg p-2 backdrop-blur-sm">
                        <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z" clip-rule="evenodd"/>
                        </svg>
                    </div>
                </div>
                <div class="text-4xl font-bold tracking-tight" id="openTrades" aria-live="polite">-</div>
                <div class="mt-2 text-xs text-green-100">Active trading positions</div>
            </div>

            <!-- Last Signal Card -->
            <div class="bg-gradient-to-br from-orange-500 to-orange-600 rounded-xl shadow-lg p-6 text-white fade-in transform transition-all duration-200 hover:scale-105 hover:shadow-xl" role="region" aria-label="Last Signal" style="animation-delay: 0.3s;">
                <div class="flex items-center justify-between mb-2">
                    <div class="text-sm font-medium text-orange-100 uppercase tracking-wide">Last Signal</div>
                    <div class="bg-white/20 rounded-lg p-2 backdrop-blur-sm">
                        <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"/>
                        </svg>
                    </div>
                </div>
                <div class="text-xl sm:text-2xl font-bold tracking-tight" id="lastSignal" aria-live="polite">-</div>
                <div class="mt-2 text-xs text-orange-100">Most recent signal time</div>
            </div>
        </div>

        <!-- Chart Analysis Section -->
        <div class="mb-8">
            <div class="card chart-analysis-card">
                <div class="card-header">
                    <h3 class="card-title">
                        <span class="text-2xl">üìä</span>
                        <span class="bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent">SUI/USDC Chart Analysis</span>
                    </h3>
                    <div class="flex items-center gap-2">
                        <span class="px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-xs font-semibold">GPT-4 Vision</span>
                        <span class="px-3 py-1 bg-purple-100 text-purple-800 rounded-full text-xs font-semibold">AI Powered</span>
                    </div>
                </div>
                <div id="chartAnalysisSection" class="card-body">
                    <div class="mb-4 relative">
                        <img id="chartImage" src="" alt="Chart analysis visualization" class="w-full h-auto rounded-lg border-2 border-blue-200 shadow-lg fade-in" style="display: none;">
                        <div id="chartLoading" class="flex flex-col justify-center items-center h-64 rounded-lg">
                            <div class="loading-spinner mb-3 w-12 h-12 border-4 border-blue-500"></div>
                            <div class="text-gray-600 text-sm font-medium">Analyzing chart with GPT-4 Vision...</div>
                            <div class="text-gray-400 text-xs mt-2">This may take a few seconds</div>
                        </div>
                    </div>

                    <!-- Analysis Results -->
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4" id="analysisResults" style="display: none;">
                        <div class="metric bounce-in" id="recommendationCard" role="region" aria-label="AI Recommendation">
                            <div class="metric-value text-lg" id="recommendation">-</div>
                            <div class="metric-label">Recommendation</div>
                        </div>
                        <div class="metric metric-neutral bounce-in" role="region" aria-label="Confidence Level" style="animation-delay: 0.1s;">
                            <div class="metric-value text-lg" id="confidence">-</div>
                            <div class="metric-label">Confidence</div>
                        </div>
                        <div class="metric metric-neutral bounce-in" role="region" aria-label="Current Price" style="animation-delay: 0.2s;">
                            <div class="metric-value text-lg" id="currentPrice">-</div>
                            <div class="metric-label">Current Price</div>
                        </div>
                        <div class="metric metric-neutral bounce-in" role="region" aria-label="24 Hour Change" style="animation-delay: 0.3s;">
                            <div class="metric-value text-lg" id="priceChange">-</div>
                            <div class="metric-label">24h Change</div>
                        </div>
                    </div>
                    
                    <!-- Key Observations -->
                    <div class="mt-4" id="observationsSection" style="display: none;">
                        <h4 class="font-semibold text-sm mb-2">üîç Key Observations</h4>
                        <ul id="observations" class="text-sm text-gray-700 space-y-1"></ul>
                    </div>
                    
                    <!-- Risk Factors -->
                    <div class="mt-4" id="riskSection" style="display: none;">
                        <h4 class="font-semibold text-sm mb-2">‚ö†Ô∏è Risk Factors</h4>
                        <ul id="riskFactors" class="text-sm text-gray-700 space-y-1"></ul>
                    </div>
                    
                    <!-- AI Reasoning -->
                    <div class="mt-4" id="reasoningSection" style="display: none;">
                        <h4 class="font-semibold text-sm mb-2">ü§ñ AI Analysis</h4>
                        <p id="reasoning" class="text-sm text-gray-700"></p>
                    </div>
                    
                    <div class="mt-4 text-xs text-gray-500" id="analysisTimestamp">
                        Last updated: -
                    </div>
                </div>
            </div>
        </div>

        <!-- Market Context Section -->
        <div class="card market-context-card mb-8">
            <div class="card-header">
                <h3 class="card-title">
                    <span class="text-2xl">üåç</span>
                    <span class="bg-gradient-to-r from-green-600 to-teal-600 bg-clip-text text-transparent">Market Context & Cross-Asset Analysis</span>
                </h3>
                <div class="flex items-center gap-2">
                    <span class="px-3 py-1 bg-green-100 text-green-800 rounded-full text-xs font-semibold">Real-Time Data</span>
                    <span class="px-3 py-1 bg-teal-100 text-teal-800 rounded-full text-xs font-semibold">Multi-Asset</span>
                </div>
            </div>

            <!-- Major Crypto Prices -->
            <div class="mb-6">
                <div class="flex items-center gap-2 mb-3">
                    <span class="text-sm font-semibold text-gray-700">üí∞ Major Crypto Assets</span>
                    <div class="h-px flex-1 bg-gradient-to-r from-green-200 to-transparent"></div>
                </div>
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
                    <div class="crypto-price-card">
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-xs font-medium text-gray-600">Bitcoin</span>
                            <span class="text-xs bg-orange-100 text-orange-800 px-2 py-0.5 rounded">BTC</span>
                        </div>
                        <div class="text-2xl font-bold text-gray-900" id="btcPrice">-</div>
                        <div class="text-sm mt-1" id="btcChange">-</div>
                    </div>
                    <div class="crypto-price-card">
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-xs font-medium text-gray-600">Ethereum</span>
                            <span class="text-xs bg-blue-100 text-blue-800 px-2 py-0.5 rounded">ETH</span>
                        </div>
                        <div class="text-2xl font-bold text-gray-900" id="ethPrice">-</div>
                        <div class="text-sm mt-1" id="ethChange">-</div>
                    </div>
                    <div class="crypto-price-card">
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-xs font-medium text-gray-600">BTC Dominance</span>
                            <span class="text-xs bg-purple-100 text-purple-800 px-2 py-0.5 rounded">DOM</span>
                        </div>
                        <div class="text-2xl font-bold text-gray-900" id="btcDominance">-</div>
                        <div class="text-xs text-gray-500 mt-1">Market Share</div>
                    </div>
                    <div class="crypto-price-card fear-greed-card">
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-xs font-medium text-gray-600">Fear & Greed</span>
                            <span class="text-xs bg-indigo-100 text-indigo-800 px-2 py-0.5 rounded">INDEX</span>
                        </div>
                        <div class="text-2xl font-bold text-gray-900" id="fearGreedIndex">-</div>
                        <div class="text-xs text-gray-500 mt-1">Sentiment</div>
                    </div>
                </div>
            </div>

            <!-- Cross-Asset Signals -->
            <div>
                <div class="flex items-center gap-2 mb-3">
                    <span class="text-sm font-semibold text-gray-700">üìä Cross-Asset Signals</span>
                    <div class="h-px flex-1 bg-gradient-to-r from-teal-200 to-transparent"></div>
                </div>
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
                    <div class="market-signal-card">
                        <div class="flex items-center gap-2 mb-2">
                            <div class="w-8 h-8 rounded-full bg-gradient-to-br from-blue-500 to-blue-600 flex items-center justify-center text-white text-sm font-bold">üìà</div>
                            <span class="text-sm font-semibold text-gray-700">Market Trend</span>
                        </div>
                        <div class="text-xl font-bold" id="marketTrend">-</div>
                    </div>
                    <div class="market-signal-card">
                        <div class="flex items-center gap-2 mb-2">
                            <div class="w-8 h-8 rounded-full bg-gradient-to-br from-orange-500 to-orange-600 flex items-center justify-center text-white text-sm font-bold">‚Çø</div>
                            <span class="text-sm font-semibold text-gray-700">BTC Trend</span>
                        </div>
                        <div class="text-xl font-bold" id="btcTrend">-</div>
                    </div>
                    <div class="market-signal-card">
                        <div class="flex items-center gap-2 mb-2">
                            <div class="w-8 h-8 rounded-full bg-gradient-to-br from-purple-500 to-purple-600 flex items-center justify-center text-white text-sm font-bold">üéØ</div>
                            <span class="text-sm font-semibold text-gray-700">Market Regime</span>
                        </div>
                        <div class="text-xl font-bold" id="marketRegime">-</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Unified Signal Aggregation Section -->
        <div class="card unified-signals-card mb-8">
            <div class="card-header">
                <h3 class="card-title">
                    <span class="text-2xl">üéØ</span>
                    <span class="bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent">Unified Signal Aggregation</span>
                </h3>
                <div class="flex items-center gap-2">
                    <span class="px-3 py-1 bg-indigo-100 text-indigo-800 rounded-full text-xs font-semibold">6 Sources</span>
                    <span class="px-3 py-1 bg-purple-100 text-purple-800 rounded-full text-xs font-semibold">AI Weighted</span>
                </div>
            </div>

            <!-- Unified Decision Display -->
            <div class="mb-6">
                <div class="unified-decision-box">
                    <div class="flex flex-col sm:flex-row justify-between items-center space-y-4 sm:space-y-0">
                        <div class="text-center sm:text-left">
                            <div class="text-sm text-gray-600 mb-1 font-medium">Unified Decision</div>
                            <div class="text-4xl font-bold unified-decision-text" id="unifiedDecision">-</div>
                        </div>
                        <div class="text-center">
                            <div class="text-sm text-gray-600 mb-1 font-medium">Signal Strength</div>
                            <div class="text-3xl font-bold text-blue-600" id="unifiedStrength">-</div>
                            <div class="text-xs text-gray-500 mt-1">out of 10</div>
                        </div>
                        <div class="text-center sm:text-right">
                            <div class="text-sm text-gray-600 mb-1 font-medium">Overall Confidence</div>
                            <div class="text-3xl font-bold text-purple-600" id="unifiedConfidence">-</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Signal Source Breakdown -->
            <div class="mb-4">
                <div class="flex items-center gap-2 mb-3">
                    <span class="text-sm font-semibold text-gray-700">üìä Signal Source Breakdown</span>
                    <div class="h-px flex-1 bg-gradient-to-r from-indigo-200 to-transparent"></div>
                </div>
                <div class="space-y-3">
                    <!-- Technical Indicators -->
                    <div class="signal-source-card">
                        <div class="flex justify-between items-center mb-2">
                            <div class="flex items-center space-x-2">
                                <div class="signal-icon-badge signal-icon-blue">üìà</div>
                                <span class="text-sm font-semibold">Technical Indicators</span>
                                <span class="text-xs bg-blue-100 text-blue-800 px-2 py-0.5 rounded font-medium">25%</span>
                            </div>
                            <span class="text-sm font-bold signal-value" id="technicalSignal">-</span>
                        </div>
                        <div class="flex items-center space-x-2">
                            <div class="flex-1 bg-gray-200 rounded-full h-2.5 overflow-hidden">
                                <div class="bg-gradient-to-r from-blue-500 to-blue-600 h-2.5 rounded-full transition-all duration-500 shadow-sm" id="technicalBar" style="width: 0%"></div>
                            </div>
                            <span class="text-xs text-gray-600 w-20 text-right font-medium" id="technicalScore">-</span>
                        </div>
                    </div>

                    <!-- RL Signal -->
                    <div class="signal-source-card">
                        <div class="flex justify-between items-center mb-2">
                            <div class="flex items-center space-x-2">
                                <div class="signal-icon-badge signal-icon-purple">üß†</div>
                                <span class="text-sm font-semibold">RL Enhancement</span>
                                <span class="text-xs bg-purple-100 text-purple-800 px-2 py-0.5 rounded font-medium">15%</span>
                            </div>
                            <span class="text-sm font-bold signal-value" id="rlSignalDisplay">-</span>
                        </div>
                        <div class="flex items-center space-x-2">
                            <div class="flex-1 bg-gray-200 rounded-full h-2.5 overflow-hidden">
                                <div class="bg-gradient-to-r from-purple-500 to-purple-600 h-2.5 rounded-full transition-all duration-500 shadow-sm" id="rlBar" style="width: 0%"></div>
                            </div>
                            <span class="text-xs text-gray-600 w-20 text-right font-medium" id="rlScore">-</span>
                        </div>
                    </div>

                    <!-- Chart Analysis -->
                    <div class="signal-source-card">
                        <div class="flex justify-between items-center mb-2">
                            <div class="flex items-center space-x-2">
                                <div class="signal-icon-badge signal-icon-green">üìä</div>
                                <span class="text-sm font-semibold">Chart Analysis</span>
                                <span class="text-xs bg-green-100 text-green-800 px-2 py-0.5 rounded font-medium">30%</span>
                            </div>
                            <span class="text-sm font-bold signal-value" id="chartSignal">-</span>
                        </div>
                        <div class="flex items-center space-x-2">
                            <div class="flex-1 bg-gray-200 rounded-full h-2.5 overflow-hidden">
                                <div class="bg-gradient-to-r from-green-500 to-green-600 h-2.5 rounded-full transition-all duration-500 shadow-sm" id="chartBar" style="width: 0%"></div>
                            </div>
                            <span class="text-xs text-gray-600 w-20 text-right font-medium" id="chartScore">-</span>
                        </div>
                    </div>

                    <!-- CrewAI Multi-Agent -->
                    <div class="signal-source-card">
                        <div class="flex justify-between items-center mb-2">
                            <div class="flex items-center space-x-2">
                                <div class="signal-icon-badge signal-icon-orange">ü§ñ</div>
                                <span class="text-sm font-semibold">AI Multi-Agent</span>
                                <span class="text-xs bg-orange-100 text-orange-800 px-2 py-0.5 rounded font-medium">15%</span>
                            </div>
                            <span class="text-sm font-bold signal-value" id="crewaiSignal">-</span>
                        </div>
                        <div class="flex items-center space-x-2">
                            <div class="flex-1 bg-gray-200 rounded-full h-2.5 overflow-hidden">
                                <div class="bg-gradient-to-r from-orange-500 to-orange-600 h-2.5 rounded-full transition-all duration-500 shadow-sm" id="crewaiBar" style="width: 0%"></div>
                            </div>
                            <span class="text-xs text-gray-600 w-20 text-right font-medium" id="crewaiScore">-</span>
                        </div>
                    </div>

                    <!-- Market Context -->
                    <div class="signal-source-card">
                        <div class="flex justify-between items-center mb-2">
                            <div class="flex items-center space-x-2">
                                <div class="signal-icon-badge signal-icon-indigo">üåç</div>
                                <span class="text-sm font-semibold">Market Context</span>
                                <span class="text-xs bg-indigo-100 text-indigo-800 px-2 py-0.5 rounded font-medium">10%</span>
                            </div>
                            <span class="text-sm font-bold signal-value" id="marketContextSignal">-</span>
                        </div>
                        <div class="flex items-center space-x-2">
                            <div class="flex-1 bg-gray-200 rounded-full h-2.5 overflow-hidden">
                                <div class="bg-gradient-to-r from-indigo-500 to-indigo-600 h-2.5 rounded-full transition-all duration-500 shadow-sm" id="marketContextBar" style="width: 0%"></div>
                            </div>
                            <span class="text-xs text-gray-600 w-20 text-right font-medium" id="marketContextScore">-</span>
                        </div>
                    </div>

                    <!-- News Sentiment -->
                    <div class="signal-source-card">
                        <div class="flex justify-between items-center mb-2">
                            <div class="flex items-center space-x-2">
                                <div class="signal-icon-badge signal-icon-pink">üì∞</div>
                                <span class="text-sm font-semibold">News Sentiment</span>
                                <span class="text-xs bg-pink-100 text-pink-800 px-2 py-0.5 rounded font-medium">5%</span>
                            </div>
                            <span class="text-sm font-bold signal-value" id="newsSignal">-</span>
                        </div>
                        <div class="flex items-center space-x-2">
                            <div class="flex-1 bg-gray-200 rounded-full h-2.5 overflow-hidden">
                                <div class="bg-gradient-to-r from-pink-500 to-pink-600 h-2.5 rounded-full transition-all duration-500 shadow-sm" id="newsBar" style="width: 0%"></div>
                            </div>
                            <span class="text-xs text-gray-600 w-20 text-right font-medium" id="newsScore">-</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Signal Details -->
            <div class="flex items-center gap-2 mb-3 mt-6">
                <span class="text-sm font-semibold text-gray-700">üìà Signal Metrics</span>
                <div class="h-px flex-1 bg-gradient-to-r from-purple-200 to-transparent"></div>
            </div>
            <div class="grid grid-cols-1 sm:grid-cols-3 gap-3">
                <div class="signal-metric-card">
                    <div class="flex items-center gap-2 mb-1">
                        <div class="w-8 h-8 rounded-full bg-gradient-to-br from-blue-500 to-blue-600 flex items-center justify-center text-white text-xs">‚è±Ô∏è</div>
                        <div class="text-xs text-gray-600 font-medium">Signal Age</div>
                    </div>
                    <div class="text-lg font-bold text-gray-900" id="signalAge">-</div>
                </div>
                <div class="signal-metric-card">
                    <div class="flex items-center gap-2 mb-1">
                        <div class="w-8 h-8 rounded-full bg-gradient-to-br from-purple-500 to-purple-600 flex items-center justify-center text-white text-xs">‚úì</div>
                        <div class="text-xs text-gray-600 font-medium">Data Quality</div>
                    </div>
                    <div class="text-lg font-bold text-gray-900" id="dataQuality">-</div>
                </div>
                <div class="signal-metric-card">
                    <div class="flex items-center gap-2 mb-1">
                        <div class="w-8 h-8 rounded-full bg-gradient-to-br from-green-500 to-green-600 flex items-center justify-center text-white text-xs">üîÑ</div>
                        <div class="text-xs text-gray-600 font-medium">Last Updated</div>
                    </div>
                    <div class="text-sm font-bold text-gray-900" id="unifiedTimestamp">-</div>
                </div>
            </div>
        </div>

        <!-- Backtesting & Strategy Analysis Section -->
        <div class="card backtest-card mb-8">
            <div class="card-header">
                <h3 class="card-title">
                    <span class="text-2xl">üìä</span>
                    <span class="bg-gradient-to-r from-teal-600 to-cyan-600 bg-clip-text text-transparent">Strategy Backtesting & Insights</span>
                </h3>
                <div class="flex items-center gap-2">
                    <span class="px-3 py-1 bg-teal-100 text-teal-800 rounded-full text-xs font-semibold">Historical Analysis</span>
                    <span class="px-3 py-1 bg-cyan-100 text-cyan-800 rounded-full text-xs font-semibold">Actionable Insights</span>
                </div>
            </div>

            <!-- Backtest Data Availability -->
            <div class="mb-6">
                <div class="flex items-center gap-2 mb-3">
                    <span class="text-sm font-semibold text-gray-700">üìà Available Data</span>
                    <div class="h-px flex-1 bg-gradient-to-r from-teal-200 to-transparent"></div>
                </div>
                <div class="grid grid-cols-1 sm:grid-cols-4 gap-3">
                    <div class="backtest-data-card">
                        <div class="text-xs text-gray-600 mb-1">Total Signals</div>
                        <div class="text-2xl font-bold text-blue-600" id="backtestSignalCount">-</div>
                        <div class="text-xs text-gray-500 mt-1" id="backtestSignalDates">-</div>
                    </div>
                    <div class="backtest-data-card">
                        <div class="text-xs text-gray-600 mb-1">BUY Signals</div>
                        <div class="text-2xl font-bold text-green-600" id="backtestBuyCount">-</div>
                        <div class="text-xs text-gray-500 mt-1">Actionable signals</div>
                    </div>
                    <div class="backtest-data-card">
                        <div class="text-xs text-gray-600 mb-1">SELL Signals</div>
                        <div class="text-2xl font-bold text-red-600" id="backtestSellCount">-</div>
                        <div class="text-xs text-gray-500 mt-1">Actionable signals</div>
                    </div>
                    <div class="backtest-data-card">
                        <div class="text-xs text-gray-600 mb-1">Data Status</div>
                        <div class="text-sm font-bold" id="backtestDataStatus">-</div>
                        <div class="text-xs text-gray-500 mt-1" id="backtestRecommendation">-</div>
                    </div>
                </div>
            </div>

            <!-- Backtest Controls -->
            <div class="mb-6">
                <div class="flex items-center gap-2 mb-3">
                    <span class="text-sm font-semibold text-gray-700">üéÆ Backtest Controls</span>
                    <div class="h-px flex-1 bg-gradient-to-r from-cyan-200 to-transparent"></div>
                </div>
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                    <button onclick="runQuickBacktest()" class="backtest-action-btn btn-blue" id="quickBacktestBtn">
                        <span class="text-2xl">‚ö°</span>
                        <div class="ml-3 text-left">
                            <div class="font-semibold">Quick Backtest</div>
                            <div class="text-xs opacity-90">Test current weight configuration</div>
                        </div>
                    </button>
                    <button onclick="runWeightOptimization()" class="backtest-action-btn btn-purple" id="optimizeBtn" title="Runs multiple backtests with different signal weight combinations to find the optimal configuration that maximizes ROI and Sharpe ratio. This process tests various weightings across Technical Indicators, RL Enhancement, Chart Analysis, AI Multi-Agent, Market Context, and News Sentiment.">
                        <span class="text-2xl">üéØ</span>
                        <div class="ml-3 text-left flex-1">
                            <div class="font-semibold flex items-center gap-1">
                                Optimize Weights
                                <span class="text-xs opacity-70" title="Click for detailed explanation">‚ÑπÔ∏è</span>
                            </div>
                            <div class="text-xs opacity-90">Find best signal weight combination</div>
                        </div>
                    </button>
                </div>
            </div>

            <!-- Backtest Results -->
            <div id="backtestResults" style="display: none;" class="mb-6">
                <div class="flex items-center gap-2 mb-3">
                    <span class="text-sm font-semibold text-gray-700">üìä Backtest Results</span>
                    <div class="h-px flex-1 bg-gradient-to-r from-green-200 to-transparent"></div>
                </div>
                <div class="grid grid-cols-2 sm:grid-cols-4 lg:grid-cols-6 gap-3 mb-4">
                    <div class="backtest-metric-card">
                        <div class="text-xs text-gray-600 mb-1">ROI</div>
                        <div class="text-xl font-bold" id="backtestROI">-</div>
                    </div>
                    <div class="backtest-metric-card">
                        <div class="text-xs text-gray-600 mb-1">Win Rate</div>
                        <div class="text-xl font-bold" id="backtestWinRate">-</div>
                    </div>
                    <div class="backtest-metric-card">
                        <div class="text-xs text-gray-600 mb-1">Total Trades</div>
                        <div class="text-xl font-bold" id="backtestTotalTrades">-</div>
                    </div>
                    <div class="backtest-metric-card">
                        <div class="text-xs text-gray-600 mb-1">Total PnL</div>
                        <div class="text-xl font-bold" id="backtestTotalPnL">-</div>
                    </div>
                    <div class="backtest-metric-card">
                        <div class="text-xs text-gray-600 mb-1">Sharpe Ratio</div>
                        <div class="text-xl font-bold" id="backtestSharpe">-</div>
                    </div>
                    <div class="backtest-metric-card">
                        <div class="text-xs text-gray-600 mb-1">Max Drawdown</div>
                        <div class="text-xl font-bold" id="backtestDrawdown">-</div>
                    </div>
                </div>
                <div class="text-xs text-gray-500 text-center">
                    Test Period: <span id="backtestPeriod">-</span>
                </div>
            </div>

            <!-- Actionable Insights -->
            <div id="backtestInsights" class="mb-6">
                <div class="flex items-center gap-2 mb-3">
                    <span class="text-sm font-semibold text-gray-700">üí° Actionable Insights</span>
                    <div class="h-px flex-1 bg-gradient-to-r from-yellow-200 to-transparent"></div>
                </div>
                <div id="insightsList" class="space-y-3">
                    <div class="text-center text-gray-500 text-sm py-4">
                        Run a backtest to generate insights for your trading decisions
                    </div>
                </div>
            </div>

            <!-- Loading State -->
            <div id="backtestLoading" style="display: none;" class="text-center py-8">
                <div class="loading-spinner mx-auto mb-3 w-12 h-12 border-4 border-teal-500"></div>
                <div class="text-gray-600 font-medium">Running backtest...</div>
                <div class="text-gray-400 text-sm mt-2">This may take a few moments</div>
            </div>
        </div>

        <!-- CrewAI Multi-Agent System Section -->
        <div class="card crewai-system-card mb-8">
            <div class="card-header">
                <h3 class="card-title">
                    <span class="text-2xl">ü§ñ</span>
                    <span class="bg-gradient-to-r from-orange-600 to-red-600 bg-clip-text text-transparent">AI Multi-Agent System</span>
                </h3>
                <div class="flex items-center gap-2">
                    <span class="px-3 py-1 bg-orange-100 text-orange-800 rounded-full text-xs font-semibold">CrewAI</span>
                    <span class="px-3 py-1 bg-red-100 text-red-800 rounded-full text-xs font-semibold">5 Agents</span>
                </div>
            </div>

            <!-- Circuit Breaker Status -->
            <div class="circuit-breaker-status mb-4">
                <div class="flex items-center justify-between mb-2">
                    <h4 class="font-semibold text-sm">üõ°Ô∏è Circuit Breaker Status</h4>
                    <span class="text-xs font-bold px-3 py-1 rounded" id="circuitBreakerBadge">Loading...</span>
                </div>
                <div class="grid grid-cols-1 sm:grid-cols-3 gap-3 text-sm">
                    <div>
                        <span class="text-gray-600">State:</span>
                        <span class="font-bold ml-2" id="circuitBreakerState">-</span>
                    </div>
                    <div>
                        <span class="text-gray-600">Last Check:</span>
                        <span class="font-bold ml-2" id="circuitBreakerLastCheck">-</span>
                    </div>
                    <div>
                        <span class="text-gray-600">Trigger Reason:</span>
                        <span class="font-bold ml-2" id="circuitBreakerReason">None</span>
                    </div>
                </div>
            </div>

            <!-- AI Agents Status -->
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-3 mb-4">
                <div class="agent-status-card">
                    <div class="text-xs text-gray-600 mb-1">üõ°Ô∏è Market Guardian</div>
                    <div class="text-sm font-bold" id="agentMarketGuardian">-</div>
                    <div class="text-xs text-gray-500" id="agentMarketGuardianActivity">-</div>
                </div>
                <div class="agent-status-card">
                    <div class="text-xs text-gray-600 mb-1">üîç Market Scanner</div>
                    <div class="text-sm font-bold" id="agentMarketScanner">-</div>
                    <div class="text-xs text-gray-500" id="agentMarketScannerActivity">-</div>
                </div>
                <div class="agent-status-card">
                    <div class="text-xs text-gray-600 mb-1">üìä Context Analyzer</div>
                    <div class="text-sm font-bold" id="agentContextAnalyzer">-</div>
                    <div class="text-xs text-gray-500" id="agentContextAnalyzerActivity">-</div>
                </div>
                <div class="agent-status-card">
                    <div class="text-xs text-gray-600 mb-1">‚öñÔ∏è Risk Assessment</div>
                    <div class="text-sm font-bold" id="agentRiskAssessment">-</div>
                    <div class="text-xs text-gray-500" id="agentRiskAssessmentActivity">-</div>
                </div>
                <div class="agent-status-card">
                    <div class="text-xs text-gray-600 mb-1">‚ö° Strategy Executor</div>
                    <div class="text-sm font-bold" id="agentStrategyExecutor">-</div>
                    <div class="text-xs text-gray-500" id="agentStrategyExecutorActivity">-</div>
                </div>
            </div>

            <!-- System Statistics -->
            <div class="grid grid-cols-2 sm:grid-cols-4 gap-3">
                <div class="system-stat-card stat-blue">
                    <div class="text-xs text-gray-600">Spikes Detected</div>
                    <div class="text-lg font-bold text-blue-600" id="spikesDetected">0</div>
                </div>
                <div class="system-stat-card stat-green">
                    <div class="text-xs text-gray-600">Agent Decisions</div>
                    <div class="text-lg font-bold text-green-600" id="agentDecisions">0</div>
                </div>
                <div class="system-stat-card stat-purple">
                    <div class="text-xs text-gray-600">CB Triggers</div>
                    <div class="text-lg font-bold text-purple-600" id="cbTriggers">0</div>
                </div>
                <div class="system-stat-card stat-orange">
                    <div class="text-xs text-gray-600">System Status</div>
                    <div class="text-sm font-bold" id="aiSystemStatus">-</div>
                </div>
            </div>
        </div>

        <!-- HyperDash Trader Monitoring Section -->
        <div class="card hyperdash-card mb-8">
            <div class="card-header">
                <h3 class="card-title">
                    <span class="text-2xl">üë§</span>
                    <span class="bg-gradient-to-r from-cyan-600 to-blue-600 bg-clip-text text-transparent">HyperDash Trader Monitor</span>
                </h3>
            </div>

            <!-- Live View Only -->
            <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-3 mb-4">
                <div class="flex items-start">
                    <span class="text-yellow-600 mr-2">‚ö†Ô∏è</span>
                    <div class="text-xs text-yellow-800">
                        <strong>Note:</strong> HyperDash has X-Frame-Options: SAMEORIGIN which may block iframe embedding from external domains. If the page doesn't load, use the "Open in New Tab" button below.
                    </div>
                </div>
            </div>

            <div class="mb-3 flex justify-end">
                <a href="https://hyperdash.info/zh-CN/trader/0xb317d2bc2d3d2df5fa441b5bae0ab9d8b07283ae"
                   target="_blank"
                   class="bg-blue-500 text-white px-4 py-2 rounded text-sm hover:bg-blue-600 inline-flex items-center">
                    üîó Open in New Tab
                </a>
            </div>

            <div class="border-2 border-gray-200 rounded-lg overflow-hidden" style="height: 800px;">
                <iframe
                    id="hyperdashIframe"
                    src="https://hyperdash.info/zh-CN/trader/0xb317d2bc2d3d2df5fa441b5bae0ab9d8b07283ae"
                    class="w-full h-full"
                    frameborder="0"
                    sandbox="allow-same-origin allow-scripts allow-popups allow-forms"
                    loading="lazy">
                </iframe>
            </div>
        </div>

        <!-- Spike Detections & Agent Decisions -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
            <!-- Recent Spike Detections -->
            <div class="card spike-decision-card">
                <div class="card-header">
                    <h3 class="card-title">
                        <span class="text-2xl">‚ö°</span>
                        <span class="bg-gradient-to-r from-red-600 to-pink-600 bg-clip-text text-transparent">Recent Spike Detections</span>
                    </h3>
                    <span class="px-3 py-1 bg-red-100 text-red-800 rounded-full text-xs font-semibold">Live</span>
                </div>
                <div class="overflow-y-auto max-h-96">
                    <div id="spikeDetectionsList" class="space-y-2">
                        <div class="text-center text-gray-500 text-sm py-8">Loading spike detections...</div>
                    </div>
                </div>
            </div>

            <!-- Recent Agent Decisions -->
            <div class="card spike-decision-card">
                <div class="card-header">
                    <h3 class="card-title">
                        <span class="text-2xl">üß†</span>
                        <span class="bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent">Recent Agent Decisions</span>
                    </h3>
                    <span class="px-3 py-1 bg-purple-100 text-purple-800 rounded-full text-xs font-semibold">AI Powered</span>
                </div>
                <div class="overflow-y-auto max-h-96">
                    <div id="agentDecisionsList" class="space-y-2">
                        <div class="text-center text-gray-500 text-sm py-8">Loading agent decisions...</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- AI Agent System Logs -->
        <div class="card logs-card mb-8">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-semibold text-gray-900">üìã AI Agent System Logs</h3>
                <div class="flex items-center space-x-2">
                    <select id="logLevelFilter" class="border border-gray-300 bg-white text-gray-900 rounded px-2 py-1 text-sm focus:outline-none focus:border-blue-500">
                        <option value="all">All Levels</option>
                        <option value="info">Info</option>
                        <option value="warning">Warning</option>
                        <option value="error">Error</option>
                    </select>
                    <button id="refreshLogsBtn" class="bg-blue-600 text-white px-3 py-1 rounded hover:bg-blue-700 text-sm transition-colors duration-200">
                        üîÑ Refresh
                    </button>
                    <button id="clearLogsBtn" class="bg-gray-500 text-white px-3 py-1 rounded hover:bg-gray-600 text-sm transition-colors duration-200">
                        üóëÔ∏è Clear
                    </button>
                </div>
            </div>
            <div class="log-terminal">
                <div id="agentLogsList" class="space-y-1">
                    <div class="text-gray-400 text-center py-8">Loading AI agent logs...</div>
                </div>
            </div>
            <div class="mt-2 text-xs text-gray-600 flex justify-between items-center">
                <span id="logCount">0 log entries</span>
                <span class="text-gray-500">Auto-refreshes every 10 seconds</span>
            </div>
        </div>

        <!-- RL Bot Live Status -->
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 sm:gap-6 mb-8">
            <div class="card rl-bot-card">
                <h3 class="text-lg font-semibold mb-4">ü§ñ RL Bot Status</h3>
                <div class="space-y-2">
                    <div class="flex justify-between items-center">
                        <span class="text-sm text-gray-600">Status:</span>
                        <span class="text-sm font-bold" id="rlBotStatus">-</span>
                    </div>
                    <div class="flex justify-between items-center">
                        <span class="text-sm text-gray-600">PID:</span>
                        <span class="text-xs font-mono" id="rlBotPid">-</span>
                    </div>
                    <div class="flex justify-between items-center">
                        <span class="text-sm text-gray-600">Last Update:</span>
                        <span class="text-xs" id="rlBotLastUpdate">-</span>
                    </div>
                    <div class="flex justify-between items-center">
                        <span class="text-sm text-gray-600">Trade Execution:</span>
                        <span class="text-xs font-bold" id="tradeExecution">-</span>
                    </div>
                </div>
            </div>

            <div class="card rl-bot-card">
                <h3 class="text-lg font-semibold mb-4">üß† RL Decision</h3>
                <div class="space-y-2">
                    <div class="flex justify-between items-center">
                        <span class="text-sm text-gray-600">Original Signal:</span>
                        <span class="text-sm font-bold" id="originalSignal">-</span>
                    </div>
                    <div class="flex justify-between items-center">
                        <span class="text-sm text-gray-600">RL Action:</span>
                        <span class="text-sm font-bold" id="rlAction">-</span>
                    </div>
                    <div class="flex justify-between items-center">
                        <span class="text-sm text-gray-600">Final Decision:</span>
                        <span class="text-sm font-bold" id="finalDecision">-</span>
                    </div>
                    <div class="mt-2 rl-decision-box text-xs" id="rlReason">
                        RL reasoning will appear here...
                    </div>
                </div>
            </div>

            <div class="card rl-bot-card">
                <h3 class="text-lg font-semibold mb-4">üìä Live Market Data</h3>
                <div class="space-y-2">
                    <div class="flex justify-between items-center">
                        <span class="text-sm text-gray-600">Price:</span>
                        <span class="text-sm font-bold" id="livePrice">-</span>
                    </div>
                    <div class="flex justify-between items-center">
                        <span class="text-sm text-gray-600">RSI:</span>
                        <span class="text-sm font-bold" id="liveRSI">-</span>
                    </div>
                    <div class="flex justify-between items-center">
                        <span class="text-sm text-gray-600">VWAP:</span>
                        <span class="text-sm font-bold" id="liveVWAP">-</span>
                    </div>
                    <div class="flex justify-between items-center">
                        <span class="text-sm text-gray-600">Current Signal:</span>
                        <span class="text-sm font-bold" id="liveSignal">-</span>
                    </div>
                </div>
            </div>

            <div class="card rl-bot-card">
                <h3 class="text-lg font-semibold mb-4">üí∞ Live Position</h3>
                <div class="space-y-2" id="livePosition">
                    <div class="text-center text-gray-500 text-sm">Loading position...</div>
                </div>
            </div>
        </div>

        <!-- Recent RL Decisions -->
        <div class="card mb-8">
            <h3 class="text-base sm:text-lg font-semibold mb-4">üîÑ Recent RL Decisions (Last 5)</h3>
            <div class="overflow-x-auto mobile-scroll">
                <table class="min-w-full">
                    <thead>
                        <tr class="border-b">
                            <th class="px-2 sm:px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase">Time</th>
                            <th class="px-2 sm:px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase">Original</th>
                            <th class="px-2 sm:px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase mobile-hide">RL Action</th>
                            <th class="px-2 sm:px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase">Final</th>
                            <th class="px-2 sm:px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase mobile-hide">Confidence</th>
                            <th class="px-2 sm:px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase">Reason</th>
                        </tr>
                    </thead>
                    <tbody id="recentDecisions">
                        <tr>
                            <td colspan="6" class="px-2 sm:px-3 py-4 text-center text-gray-500 text-sm">Loading recent decisions...</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Market News -->
        <div class="card mb-8">
            <div class="flex justify-between items-center mb-4">
                <div class="flex items-center space-x-3">
                    <h3 class="text-base sm:text-lg font-semibold">üì∞ Market News</h3>
                    <div id="marketSentiment" class="hidden px-2 py-1 rounded text-xs font-medium">
                        <!-- Market sentiment will be displayed here -->
                    </div>
                </div>
                <div class="text-xs text-gray-500" id="newsPaginationInfo">
                    Loading news...
                </div>
            </div>
            <div id="newsContainer" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-4">
                <!-- News articles will be loaded here -->
            </div>
            <!-- News Pagination Controls -->
            <div id="newsPagination" class="flex justify-center items-center space-x-2 mt-4" style="display: none;">
                <button id="newsPrevBtn" class="px-3 py-1 bg-gray-200 text-gray-700 rounded hover:bg-gray-300 disabled:opacity-50 disabled:cursor-not-allowed text-sm" onclick="goToPreviousNewsPage()" disabled>
                    ‚Üê Previous
                </button>
                <div id="newsPageNumbers" class="flex space-x-1">
                    <!-- Page numbers will be inserted here -->
                </div>
                <button id="newsNextBtn" class="px-3 py-1 bg-gray-200 text-gray-700 rounded hover:bg-gray-300 disabled:opacity-50 disabled:cursor-not-allowed text-sm" onclick="goToNextNewsPage()" disabled>
                    Next ‚Üí
                </button>
            </div>
        </div>

        <!-- Performance Metrics -->
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6 mb-8">
            <div class="card performance-card">
                <h3 class="text-lg font-semibold mb-4">üìä Performance Metrics</h3>
                <div class="space-y-2">
                    <div class="performance-metric">
                        <span>Win Rate:</span>
                        <span class="font-bold" id="winRate">-</span>
                    </div>
                    <div class="performance-metric">
                        <span>Total PnL:</span>
                        <span class="font-bold" id="totalPnl">-</span>
                    </div>
                    <div class="performance-metric metric-positive">
                        <span>Average Win:</span>
                        <span class="font-bold" id="avgWin">-</span>
                    </div>
                    <div class="performance-metric metric-negative">
                        <span>Average Loss:</span>
                        <span class="font-bold" id="avgLoss">-</span>
                    </div>
                    <div class="performance-metric">
                        <span>Risk-Reward:</span>
                        <span class="font-bold" id="riskReward">-</span>
                    </div>
                </div>
            </div>

            <div class="card performance-card">
                <h3 class="text-lg font-semibold mb-4">üí∞ Trade Breakdown</h3>
                <div class="space-y-2">
                    <div class="performance-metric">
                        <span>Total Trades:</span>
                        <span class="font-bold" id="performanceTotalTrades">-</span>
                    </div>
                    <div class="performance-metric metric-positive">
                        <span>Winning:</span>
                        <span class="font-bold" id="winningTrades">-</span>
                    </div>
                    <div class="performance-metric metric-negative">
                        <span>Losing:</span>
                        <span class="font-bold" id="losingTrades">-</span>
                    </div>
                    <div class="performance-metric metric-negative">
                        <span>Max Loss:</span>
                        <span class="font-bold" id="maxLoss">-</span>
                    </div>
                </div>
            </div>

            <div class="card performance-card">
                <h3 class="text-lg font-semibold mb-4">üîµ Open Positions</h3>
                <div id="openPositions" class="space-y-2">
                    <div class="text-center text-gray-500">Loading...</div>
                </div>
            </div>
        </div>

        <!-- Projected Balance Section -->
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6 mb-8">
            <div class="card">
                <h3 class="text-lg font-semibold mb-4">üîÆ Projected Balance</h3>
                <div class="space-y-3">
                    <div class="flex justify-between">
                        <span>Current Balance:</span>
                        <span class="font-bold text-blue-600" id="currentBalance">-</span>
                    </div>
                    <div class="flex justify-between">
                        <span>30-Day Conservative:</span>
                        <span class="font-bold text-green-600" id="conservativeProjection">-</span>
                    </div>
                    <div class="flex justify-between">
                        <span>30-Day Realistic:</span>
                        <span class="font-bold text-blue-600" id="realisticProjection">-</span>
                    </div>
                    <div class="flex justify-between">
                        <span>30-Day RL Enhanced:</span>
                        <span class="font-bold text-purple-600" id="rlProjection">-</span>
                    </div>
                    <div class="text-xs text-gray-500 mt-2">
                        <span id="projectionNote">Based on historical performance</span>
                    </div>
                </div>
            </div>
            <div class="card">
                <h3 class="text-lg font-semibold mb-4">üìä Projection Scenarios</h3>
                <canvas id="projectionChart" width="400" height="200"></canvas>
            </div>
            <div class="card">
                <h3 class="text-lg font-semibold mb-4">üé≤ Risk Assessment</h3>
                <div class="space-y-3">
                    <div class="flex justify-between">
                        <span>Best Case (90 days):</span>
                        <span class="font-bold text-green-600" id="bestCase">-</span>
                    </div>
                    <div class="flex justify-between">
                        <span>Worst Case (90 days):</span>
                        <span class="font-bold text-red-600" id="worstCase">-</span>
                    </div>
                    <div class="flex justify-between">
                        <span>Expected Range:</span>
                        <span class="font-bold text-gray-600" id="expectedRange">-</span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-2.5 mt-2">
                        <div class="bg-blue-600 h-2.5 rounded-full" style="width: 0%" id="confidenceBar"></div>
                    </div>
                    <div class="text-xs text-gray-500">
                        <span id="confidenceText">Prediction confidence</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Charts Section -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6 mb-8">
            <div class="card">
                <h3 class="text-base sm:text-lg font-semibold mb-4">üìà Cumulative PnL</h3>
                <div class="chart-container">
                    <canvas id="pnlChart"></canvas>
                </div>
            </div>
            <div class="card">
                <h3 class="text-base sm:text-lg font-semibold mb-4">üéØ Signal Strength</h3>
                <div class="chart-container">
                    <canvas id="signalChart"></canvas>
                </div>
            </div>
        </div>

        <!-- Data Tables -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <!-- Recent Signals -->
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">üéØ Recent Signals</h3>
                </div>
                <div class="table-container custom-scrollbar">
                    <table class="table-enhanced" role="table" aria-label="Recent trading signals">
                        <thead>
                            <tr>
                                <th scope="col">Time</th>
                                <th scope="col">Signal</th>
                                <th scope="col">Strength</th>
                                <th scope="col">Price</th>
                                <th scope="col">Status</th>
                            </tr>
                        </thead>
                        <tbody id="signalsTable">
                            <tr>
                                <td colspan="5" class="text-center py-8 text-gray-500">
                                    <div class="flex flex-col items-center">
                                        <div class="loading-spinner mb-2"></div>
                                        <span class="text-sm">Loading signals...</span>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Recent Trades -->
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">üí∞ Recent Trades</h3>
                </div>
                <div class="table-container custom-scrollbar">
                    <table class="table-enhanced" role="table" aria-label="Recent trades">
                        <thead>
                            <tr>
                                <th scope="col">Time</th>
                                <th scope="col">Side</th>
                                <th scope="col">Entry</th>
                                <th scope="col">PnL</th>
                                <th scope="col">Status</th>
                            </tr>
                        </thead>
                        <tbody id="tradesTable">
                            <tr>
                                <td colspan="5" class="text-center py-8 text-gray-500">
                                    <div class="flex flex-col items-center">
                                        <div class="loading-spinner mb-2"></div>
                                        <span class="text-sm">Loading trades...</span>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- PIN Modal for Bot Control -->
    <div id="pinModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 fade-in" style="display: none;" role="dialog" aria-labelledby="pinModalTitle" aria-modal="true">
        <div class="bg-white rounded-xl p-6 w-96 max-w-md mx-4 shadow-xl bounce-in">
            <div class="text-center mb-6">
                <h3 id="pinModalTitle" class="text-lg font-bold text-gray-900 mb-2">üîê Bot Control Authentication</h3>
                <p class="text-gray-600 text-sm">Enter your 6-digit PIN to control the trading bot</p>
            </div>

            <div class="mb-4">
                <input
                    type="password"
                    id="controlPin"
                    placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
                    maxlength="6"
                    class="focus-visible w-full text-center text-2xl font-mono bg-gray-50 border border-gray-300 rounded-lg px-4 py-3 transition-all duration-200 hover:border-gray-400"
                    autocomplete="off"
                    inputmode="numeric"
                    pattern="[0-9]{6}"
                    aria-label="Enter 6-digit PIN"
                    aria-required="true"
                />
                <p class="text-xs text-gray-500 mt-1 text-center">6 digits required</p>
            </div>

            <!-- Error and status messages -->
            <div id="pinError" class="mb-4 p-3 bg-red-100 text-red-700 rounded-lg text-sm slide-in-right" style="display: none;" role="alert"></div>
            <div id="pinBlocked" class="mb-4 p-3 bg-orange-100 text-orange-700 rounded-lg text-sm slide-in-right" style="display: none;" role="alert"></div>
            <div id="pinSuccess" class="mb-4 p-3 bg-green-100 text-green-700 rounded-lg text-sm slide-in-right" style="display: none;" role="status"></div>

            <div class="flex space-x-3">
                <button
                    onclick="closePinModal()"
                    class="btn btn-secondary flex-1"
                    aria-label="Cancel PIN entry"
                >
                    Cancel
                </button>
                <button
                    onclick="submitPin()"
                    id="submitPinBtn"
                    class="btn btn-primary flex-1"
                    aria-label="Submit PIN"
                >
                    Submit
                </button>
            </div>

            <div class="mt-4 text-xs text-gray-500 text-center">
                <p>‚ö†Ô∏è 3 attempts allowed. 15-minute lockout after failed attempts.</p>
            </div>
        </div>
    </div>

    <script src="/static/dashboard.js"></script>
    <script src="/static/backtest_dashboard.js"></script>
</body>
</html>